{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "carousel",
  "files": [
    {
      "path": "components/carousel.tsx",
      "content": "//@ts-nocheck\n\"use client\"\n\nimport type React from \"react\"\nimport { useCallback, useEffect, useRef, useState } from \"react\"\nimport type { EmblaCarouselType, EmblaOptionsType } from \"embla-carousel\"\nimport Autoplay from \"embla-carousel-autoplay\"\nimport useEmblaCarousel from \"embla-carousel-react\"\nimport {\n  ChevronLeft,\n  ChevronRight,\n  Maximize2,\n  Pause,\n  Play,\n  X,\n} from \"lucide-react\"\n\nimport { Button } from \"@/components/ui/button\"\n\n// ─────────────────────────────────────────────\n//  TYPES\n// ─────────────────────────────────────────────\n\ntype ThumbPosition = \"bottom\" | \"left\" | \"right\"\n\ntype PropType = {\n  slides?: React.ReactNode[]\n  options?: EmblaOptionsType\n  /** Show thumbnail strip. Position defaults to \"bottom\". */\n  thumbnails?: React.ReactNode[]\n  thumbPosition?: ThumbPosition\n  /** Show prev/next arrow buttons */\n  showArrows?: boolean\n  /** Show progress bar */\n  showProgress?: boolean\n  /** Show dot navigation */\n  showDots?: boolean\n  /** Show slide counter  e.g. \"2 / 5\" */\n  showCounter?: boolean\n  showPlay?: boolean\n  /** Enable keyboard navigation (← →) */\n  keyboardNavigation?: boolean\n  /** Enable lightbox on slide click */\n  lightbox?: boolean\n  /** Slide transition: \"slide\" | \"fade\" */\n  transition?: \"slide\" | \"fade\"\n  /** Autoplay delay in ms. Pass 0 to disable. */\n  autoplayDelay?: number\n  /** Caption text per slide */\n  captions?: string[]\n}\n\n// ─────────────────────────────────────────────\n//  MAIN CAROUSEL\n// ─────────────────────────────────────────────\n\nconst Carousel: React.FC<PropType> = (props) => {\n  const {\n    slides = [],\n    options,\n    thumbnails = [],\n    thumbPosition = \"bottom\",\n    showArrows = false,\n    showProgress = true,\n    showDots = true,\n    showPlay = true,\n    showCounter = false,\n    keyboardNavigation = false,\n    lightbox = false,\n    transition = \"slide\",\n    autoplayDelay = 3000,\n    captions = [],\n  } = props\n\n  const progressNode = useRef<HTMLDivElement>(null)\n  const [lightboxOpen, setLightboxOpen] = useState(false)\n  const [lightboxIndex, setLightboxIndex] = useState(0)\n\n  const [emblaRef, emblaApi] = useEmblaCarousel(\n    {\n      ...options,\n      // fade mode uses a CSS trick; Embla doesn't support it natively but we\n      // layer opacity via CSS class toggling driven by selectedIndex\n    },\n    autoplayDelay > 0\n      ? [Autoplay({ playOnInit: true, delay: autoplayDelay })]\n      : []\n  )\n\n  const { autoplayIsPlaying, toggleAutoplay, onAutoplayButtonClick } =\n    useAutoplay(emblaApi)\n\n  const { showAutoplayProgress } = useAutoplayProgress(\n    emblaApi,\n    progressNode as React.RefObject<HTMLElement>\n  )\n\n  const { selectedIndex, scrollSnaps, onDotButtonClick } =\n    useDotButton(emblaApi)\n\n  const {\n    prevBtnDisabled,\n    nextBtnDisabled,\n    onPrevButtonClick,\n    onNextButtonClick,\n  } = usePrevNextButtons(emblaApi)\n\n  // ── Thumbnail sync ──\n  const [thumbEmblaRef, thumbEmblaApi] = useEmblaCarousel({\n    containScroll: \"keepSnaps\",\n    dragFree: true,\n  })\n\n  useEffect(() => {\n    if (!emblaApi || !thumbEmblaApi) return\n    emblaApi.on(\"select\", () => {\n      thumbEmblaApi.scrollTo(emblaApi.selectedScrollSnap())\n    })\n  }, [emblaApi, thumbEmblaApi])\n\n  // ── Keyboard navigation ──\n  useEffect(() => {\n    if (!keyboardNavigation || !emblaApi) return\n    const handleKey = (e: KeyboardEvent) => {\n      if (e.key === \"ArrowLeft\") emblaApi.scrollPrev()\n      if (e.key === \"ArrowRight\") emblaApi.scrollNext()\n    }\n    window.addEventListener(\"keydown\", handleKey)\n    return () => window.removeEventListener(\"keydown\", handleKey)\n  }, [keyboardNavigation, emblaApi])\n\n  // ── Lightbox close on Escape ──\n  useEffect(() => {\n    if (!lightbox) return\n    const handleKey = (e: KeyboardEvent) => {\n      if (e.key === \"Escape\") setLightboxOpen(false)\n    }\n    window.addEventListener(\"keydown\", handleKey)\n    return () => window.removeEventListener(\"keydown\", handleKey)\n  }, [lightbox])\n\n  const handleSlideClick = (index: number) => {\n    if (!lightbox) return\n    setLightboxIndex(index)\n    setLightboxOpen(true)\n  }\n\n  // ── Vertical thumbnail layout helper ──\n  const isVerticalThumb =\n    thumbnails && (thumbPosition === \"left\" || thumbPosition === \"right\")\n\n  return (\n    <div className={`flex ${isVerticalThumb ? \"flex-row gap-3\" : \"flex-col\"}`}>\n      {/* ── Left Thumbnails ── */}\n      {thumbnails && thumbPosition === \"left\" && (\n        <ThumbStrip\n          emblaRef={thumbEmblaRef}\n          thumbnails={thumbnails}\n          selectedIndex={selectedIndex}\n          onDotButtonClick={onDotButtonClick}\n          onAutoplayButtonClick={onAutoplayButtonClick}\n          direction=\"vertical\"\n        />\n      )}\n\n      <div className=\"min-w-0 flex-1\">\n        <div className=\"overflow-hidden\" ref={emblaRef}>\n          <div\n            className={`flex touch-pan-y touch-pinch-zoom ${\n              transition === \"fade\" ? \"relative\" : \"mr-3 ml-auto\"\n            }`}\n          >\n            {slides.map((slideContent, index) => (\n              <div\n                key={index}\n                onClick={() => handleSlideClick(index)}\n                className={` ${\n                  transition === \"fade\"\n                    ? `absolute inset-0 transition-opacity duration-700 ${\n                        index === selectedIndex\n                          ? \"relative opacity-100\"\n                          : \"absolute opacity-0\"\n                      }`\n                    : \"flex-[0_0_70%] transform-gpu pl-3\"\n                } ${lightbox ? \"cursor-zoom-in\" : \"\"} `}\n              >\n                {slideContent}\n              </div>\n            ))}\n          </div>\n        </div>\n\n        {/* ── Caption ── */}\n        {captions && captions[selectedIndex] && (\n          <p className=\"text-muted-foreground mt-2 px-4 text-center text-sm italic transition-all duration-300\">\n            {captions[selectedIndex]}\n          </p>\n        )}\n\n        {/* ── Bottom Thumbnails ── */}\n        {thumbnails && thumbPosition === \"bottom\" && (\n          <ThumbStrip\n            emblaRef={thumbEmblaRef}\n            thumbnails={thumbnails}\n            selectedIndex={selectedIndex}\n            onDotButtonClick={onDotButtonClick}\n            onAutoplayButtonClick={onAutoplayButtonClick}\n            direction=\"horizontal\"\n          />\n        )}\n\n        {/* ── Controls Row ── */}\n        <div className=\"mx-auto mt-7 flex max-w-100 items-center justify-center gap-3\">\n          {/* Arrows (left side) */}\n          {showArrows && (\n            <div className=\"flex items-center gap-1\">\n              <PrevButton\n                onClick={() => onAutoplayButtonClick(() => onPrevButtonClick())}\n                disabled={prevBtnDisabled}\n              />\n              <NextButton\n                onClick={() => onAutoplayButtonClick(() => onNextButtonClick())}\n                disabled={nextBtnDisabled}\n              />\n            </div>\n          )}\n\n          {/* Dots */}\n          {showDots && (\n            <div className=\"flex w-full justify-center gap-2\">\n              {scrollSnaps.map((_, index) => (\n                <DotButton\n                  key={index}\n                  onClick={() =>\n                    onAutoplayButtonClick(() => onDotButtonClick(index))\n                  }\n                  className={`border-border h-3 w-3 rounded-full border-2 transition-colors duration-200 ${\n                    index === selectedIndex\n                      ? \"bg-foreground\"\n                      : \"hover:bg-muted bg-transparent\"\n                  }`}\n                />\n              ))}\n            </div>\n          )}\n\n          {/* Slide Counter */}\n          {showCounter && (\n            <span className=\"text-muted-foreground w-full text-xs font-medium text-nowrap tabular-nums\">\n              {selectedIndex + 1} / {scrollSnaps.length}\n            </span>\n          )}\n\n          {/* Progress Bar */}\n          {showProgress && autoplayDelay > 0 && (\n            <div\n              className={`border-border bg-background relative h-2 w-full justify-center overflow-hidden rounded-sm border-2 transition-opacity duration-300 ease-in-out ${\n                showAutoplayProgress ? \"opacity-100\" : \"opacity-0\"\n              }`}\n            >\n              <div\n                className=\"bg-foreground absolute top-0 bottom-0 -left-full w-full animate-[autoplay-progress_linear_1] [animation-play-state:running]\"\n                ref={progressNode}\n                style={{\n                  animationPlayState: showAutoplayProgress\n                    ? \"running\"\n                    : \"paused\",\n                }}\n              />\n            </div>\n          )}\n\n          {showPlay && autoplayDelay > 0 && (\n            <Button\n              size={\"icon\"}\n              variant={\"secondary\"}\n              onClick={toggleAutoplay}\n              type=\"button\"\n            >\n              {autoplayIsPlaying ? (\n                <Pause fill=\"currentColor\" />\n              ) : (\n                <Play fill=\"currentColor\" />\n              )}\n            </Button>\n          )}\n        </div>\n      </div>\n\n      {/* ── Right Thumbnails ── */}\n      {thumbnails && thumbPosition === \"right\" && (\n        <ThumbStrip\n          emblaRef={thumbEmblaRef}\n          thumbnails={thumbnails}\n          selectedIndex={selectedIndex}\n          onDotButtonClick={onDotButtonClick}\n          onAutoplayButtonClick={onAutoplayButtonClick}\n          direction=\"vertical\"\n        />\n      )}\n\n      {/* ── Lightbox Overlay ── */}\n      {lightbox && lightboxOpen && (\n        <Lightbox\n          slides={slides}\n          initialIndex={lightboxIndex}\n          onClose={() => setLightboxOpen(false)}\n        />\n      )}\n    </div>\n  )\n}\n\n// ─────────────────────────────────────────────\n//  THUMBNAIL STRIP\n// ─────────────────────────────────────────────\n\ntype ThumbStripProps = {\n  emblaRef: React.RefCallback<HTMLElement>\n  thumbnails: React.ReactNode[]\n  selectedIndex: number\n  onDotButtonClick: (index: number) => void\n  onAutoplayButtonClick: (callback: () => void) => void\n  direction: \"horizontal\" | \"vertical\"\n}\n\nconst ThumbStrip: React.FC<ThumbStripProps> = ({\n  emblaRef,\n  thumbnails,\n  selectedIndex,\n  onDotButtonClick,\n  onAutoplayButtonClick,\n  direction,\n}) => {\n  return (\n    <div\n      className={`flex h-full items-center justify-center overflow-hidden ${\n        direction === \"vertical\" ? \"w-20 flex-col\" : \"mt-3 h-full w-full\"\n      }`}\n      ref={emblaRef}\n    >\n      <div\n        className={`flex gap-2 ${\n          direction === \"vertical\" ? \"flex-col\" : \"flex-row\"\n        }`}\n      >\n        {thumbnails?.map((thumb, index) => (\n          <button\n            key={index}\n            type=\"button\"\n            onClick={() => onAutoplayButtonClick(() => onDotButtonClick(index))}\n            className={`flex-shrink-0 overflow-hidden rounded-md border-2 object-cover transition-all duration-200 ${\n              direction === \"vertical\" ? \"h-auto w-16\" : \"h-12 w-auto\"\n            } ${\n              index === selectedIndex\n                ? \"scale-105 border opacity-100\"\n                : \"border opacity-20 hover:opacity-80\"\n            }`}\n          >\n            {thumb}\n          </button>\n        ))}\n      </div>\n    </div>\n  )\n}\n\n// ─────────────────────────────────────────────\n//  LIGHTBOX\n// ─────────────────────────────────────────────\n\ntype LightboxProps = {\n  slides: React.ReactNode[]\n  initialIndex: number\n  onClose: () => void\n}\n\nconst Lightbox: React.FC<LightboxProps> = ({\n  slides,\n  initialIndex,\n  onClose,\n}) => {\n  const [current, setCurrent] = useState(initialIndex)\n\n  const prev = () => setCurrent((c) => (c - 1 + slides.length) % slides.length)\n  const next = () => setCurrent((c) => (c + 1) % slides.length)\n\n  useEffect(() => {\n    const handleKey = (e: KeyboardEvent) => {\n      if (e.key === \"ArrowLeft\") prev()\n      if (e.key === \"ArrowRight\") next()\n    }\n    window.addEventListener(\"keydown\", handleKey)\n    return () => window.removeEventListener(\"keydown\", handleKey)\n  }, [])\n\n  return (\n    <div\n      className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/90\"\n      onClick={onClose}\n    >\n      <button\n        type=\"button\"\n        className=\"absolute top-4 right-4 text-white transition-colors hover:text-gray-300\"\n        onClick={onClose}\n      >\n        <X size={32} />\n      </button>\n\n      <button\n        type=\"button\"\n        className=\"absolute left-4 text-white transition-colors hover:text-gray-300\"\n        onClick={(e) => {\n          e.stopPropagation()\n          prev()\n        }}\n      >\n        <ChevronLeft size={40} />\n      </button>\n\n      <div\n        className=\"max-h-[85vh] w-full max-w-4xl px-16\"\n        onClick={(e) => e.stopPropagation()}\n      >\n        {slides[current]}\n      </div>\n\n      <button\n        type=\"button\"\n        className=\"absolute right-4 text-white transition-colors hover:text-gray-300\"\n        onClick={(e) => {\n          e.stopPropagation()\n          next()\n        }}\n      >\n        <ChevronRight size={40} />\n      </button>\n\n      <span className=\"absolute bottom-4 text-sm text-white/60 tabular-nums\">\n        {current + 1} / {slides.length}\n      </span>\n    </div>\n  )\n}\n\n// ─────────────────────────────────────────────\n//  HOOKS (unchanged originals + new touch swipe)\n// ─────────────────────────────────────────────\n\ntype UseDotButtonType = {\n  selectedIndex: number\n  scrollSnaps: number[]\n  onDotButtonClick: (index: number) => void\n}\n\nexport const useDotButton = (\n  emblaApi: EmblaCarouselType | undefined\n): UseDotButtonType => {\n  const [selectedIndex, setSelectedIndex] = useState(0)\n  const [scrollSnaps, setScrollSnaps] = useState<number[]>([])\n\n  const onDotButtonClick = useCallback(\n    (index: number) => {\n      if (!emblaApi) return\n      emblaApi.scrollTo(index)\n    },\n    [emblaApi]\n  )\n\n  const onInit = useCallback((emblaApi: EmblaCarouselType) => {\n    setScrollSnaps(emblaApi.scrollSnapList())\n  }, [])\n\n  const onSelect = useCallback((emblaApi: EmblaCarouselType) => {\n    setSelectedIndex(emblaApi.selectedScrollSnap())\n  }, [])\n\n  useEffect(() => {\n    if (!emblaApi) return\n    onInit(emblaApi)\n    onSelect(emblaApi)\n    emblaApi.on(\"reInit\", onInit).on(\"reInit\", onSelect).on(\"select\", onSelect)\n  }, [emblaApi, onInit, onSelect])\n\n  return { selectedIndex, scrollSnaps, onDotButtonClick }\n}\n\nexport const DotButton: React.FC<PropTypeButton> = (props) => {\n  const { children, ...restProps } = props\n  return (\n    <button type=\"button\" {...restProps}>\n      {children}\n    </button>\n  )\n}\n\ntype UseAutoplayProgressType = { showAutoplayProgress: boolean }\n\nexport const useAutoplayProgress = <ProgressElement extends HTMLElement>(\n  emblaApi: EmblaCarouselType | undefined,\n  progressNode: React.RefObject<ProgressElement>\n): UseAutoplayProgressType => {\n  const [showAutoplayProgress, setShowAutoplayProgress] = useState(false)\n  const animationName = useRef(\"\")\n  const timeoutId = useRef(0)\n  const rafId = useRef(0)\n\n  const startProgress = useCallback((timeUntilNext: number | null) => {\n    const node = progressNode.current\n    if (!node) return\n    if (timeUntilNext === null) return\n\n    if (!animationName.current) {\n      const style = window.getComputedStyle(node)\n      animationName.current = style.animationName\n    }\n\n    node.style.animationName = \"none\"\n    node.style.transform = \"translate3d(0,0,0)\"\n\n    rafId.current = window.requestAnimationFrame(() => {\n      timeoutId.current = window.setTimeout(() => {\n        node.style.animationName = animationName.current\n        node.style.animationDuration = `${timeUntilNext}ms`\n      }, 0)\n    })\n\n    setShowAutoplayProgress(true)\n  }, [])\n\n  useEffect(() => {\n    const autoplay = emblaApi?.plugins()?.autoplay\n    if (!autoplay) return\n    emblaApi\n      .on(\"autoplay:timerset\", () => startProgress(autoplay.timeUntilNext()))\n      .on(\"autoplay:timerstopped\", () => setShowAutoplayProgress(false))\n  }, [emblaApi])\n\n  useEffect(() => {\n    return () => {\n      cancelAnimationFrame(rafId.current)\n      clearTimeout(timeoutId.current)\n    }\n  }, [])\n\n  return { showAutoplayProgress }\n}\n\ntype UseAutoplayType = {\n  autoplayIsPlaying: boolean\n  toggleAutoplay: () => void\n  onAutoplayButtonClick: (callback: () => void) => void\n}\n\nexport const useAutoplay = (\n  emblaApi: EmblaCarouselType | undefined\n): UseAutoplayType => {\n  const [autoplayIsPlaying, setAutoplayIsPlaying] = useState(false)\n\n  const onAutoplayButtonClick = useCallback(\n    (callback: () => void) => {\n      const autoplay = emblaApi?.plugins()?.autoplay\n      if (!autoplay) return\n      const resetOrStop =\n        autoplay.options.stopOnInteraction === false\n          ? autoplay.reset\n          : autoplay.stop\n      resetOrStop()\n      callback()\n    },\n    [emblaApi]\n  )\n\n  const toggleAutoplay = useCallback(() => {\n    const autoplay = emblaApi?.plugins()?.autoplay\n    if (!autoplay) return\n    const playOrStop = autoplay.isPlaying() ? autoplay.stop : autoplay.play\n    playOrStop()\n  }, [emblaApi])\n\n  useEffect(() => {\n    const autoplay = emblaApi?.plugins()?.autoplay\n    if (!autoplay) return\n    setAutoplayIsPlaying(autoplay.isPlaying())\n    emblaApi\n      .on(\"autoplay:play\", () => setAutoplayIsPlaying(true))\n      .on(\"autoplay:stop\", () => setAutoplayIsPlaying(false))\n      .on(\"reInit\", () => setAutoplayIsPlaying(autoplay.isPlaying()))\n  }, [emblaApi])\n\n  return { autoplayIsPlaying, toggleAutoplay, onAutoplayButtonClick }\n}\n\ntype UsePrevNextButtonsType = {\n  prevBtnDisabled: boolean\n  nextBtnDisabled: boolean\n  onPrevButtonClick: () => void\n  onNextButtonClick: () => void\n}\n\nexport const usePrevNextButtons = (\n  emblaApi: EmblaCarouselType | undefined\n): UsePrevNextButtonsType => {\n  const [prevBtnDisabled, setPrevBtnDisabled] = useState(true)\n  const [nextBtnDisabled, setNextBtnDisabled] = useState(true)\n\n  const onPrevButtonClick = useCallback(() => {\n    if (!emblaApi) return\n    emblaApi.scrollPrev()\n  }, [emblaApi])\n\n  const onNextButtonClick = useCallback(() => {\n    if (!emblaApi) return\n    emblaApi.scrollNext()\n  }, [emblaApi])\n\n  const onSelect = useCallback((emblaApi: EmblaCarouselType) => {\n    setPrevBtnDisabled(!emblaApi.canScrollPrev())\n    setNextBtnDisabled(!emblaApi.canScrollNext())\n  }, [])\n\n  useEffect(() => {\n    if (!emblaApi) return\n    onSelect(emblaApi)\n    emblaApi.on(\"reInit\", onSelect).on(\"select\", onSelect)\n  }, [emblaApi, onSelect])\n\n  return {\n    prevBtnDisabled,\n    nextBtnDisabled,\n    onPrevButtonClick,\n    onNextButtonClick,\n  }\n}\n\ntype PropTypeButton = React.PropsWithChildren<\n  React.DetailedHTMLProps<\n    React.ButtonHTMLAttributes<HTMLButtonElement>,\n    HTMLButtonElement\n  >\n>\n\nexport const PrevButton: React.FC<PropTypeButton> = (props) => {\n  const { children, ...restProps } = props\n  return (\n    <Button type=\"button\" {...restProps}>\n      <ChevronLeft />\n      {children}\n    </Button>\n  )\n}\n\nexport const NextButton: React.FC<PropTypeButton> = (props) => {\n  const { children, ...restProps } = props\n  return (\n    <Button className=\"\" type=\"button\" {...restProps}>\n      <ChevronRight />\n      {children}\n    </Button>\n  )\n}\n\nexport { Carousel }\n",
      "type": "registry:component"
    }
  ],
  "type": "registry:component"
}